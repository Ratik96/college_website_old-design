{%extends 'base.html'%}

{%block head%}
	{%load static%}
	<link rel="stylesheet" type="text/css" href='{% static "mainsite/profile.css" %}'>
{%endblock%}

{%block body%}
	<div class="container">
    <div class="row">
      <div class="col-md-5" id="sidebar">
        <img class="img-responsive" src={{profile.picture.url}} alt='Profile photo for teacher'>
      </div>
      
      
      <div class="col-md-7" id="content">
        <h1>{{profile.user.first_name}}</h1>
        <h4>{{profile.qualification}},  </h4> 
        <h4><a href='{{profile.dept.get_absolute_url}}'>{{profile.dept}}</a></h4>
      </div>
    </div>
	<a href='{%url "site_logout"%}'>Logout</a>
    <div id='Attendance'>





<hr>
{%if user.is_authenticated%}
	<div id='tabs'>
		<ul>
			<li>Inbox
				<li>
				{{eca}}
				</li>
			</li>
			<li>Attendance</li>
			<li>Profile</li>
			<li>Forms
				<ul>
					<li><a href={%url "view_eca"%}>View ECA</a></li>
					<li><a href={%url "request_eca"%}>Submit ECA</a></li>
				</ul>
			</li>
		</ul>
	</div>
<hr>

      	{%if student_attendance%}
      	<div>
		<section>
			<h2 style="text-align: center; color: white;">Attendance summary</h2>
			<div id="chart" style="margin-top: 40px;">
				<!-- Pie chart goes here -->
			</div>
			<script>
			  google.load('visualization', '1.0', {'packages':['corechart']});
			  google.setOnLoadCallback(drawChart);
			  function drawChart() {
					var data = new google.visualization.DataTable();
					data.addColumn('string', 'Type');
					data.addColumn('number', 'Value');
					var total_attend={%for i in student_attendance%}{{i.lecture}}+{{i.tutorial}}+{{i.practical}}+{%endfor%}0;
					var total_classes={%for i in student_attendance%}{{i.class_attendance.lecture}}+{{i.class_attendance.tutorial}}+{{i.class_attendance.practical}}+{%endfor%}0;
					data.addRows([
				  	['Attended', total_attend],
				  	['Missed', total_classes-total_attend],
					]);
					var options = {'pieHole':0.2};
					var chart = new google.visualization.PieChart(document.getElementById('chart'));
					chart.draw(data, options);
			  }

			  $(window).resize(function(){
		      drawChart();
		    });
			  // Remove select menu from DOM
			  $('.stud-select').remove();
			  // Remove namecloud from DOM
			  $('#namecloud').remove();
			</script>	
		</section>

		<hr class="divider">
		
		<section>
			<h2 style="text-align: center; color: white;">More information</h2>
			<div class="more-info" style="color: white; max-width: 1000px; margin: 0 auto; margin-top: 40px;">
				<ul id="lgnd">
					<li><strong>T</strong> = Tutorial</li>
					<li><strong>L</strong> = Lecture</li>
					<li><strong>P</strong> = Practical</li>
					<li><strong>TT</strong> = Total Tutorials</li>
					<li><strong>TL</strong> = Total Lectures</li>
					<li><strong>TP</strong> = Total Practicals</li>
				</ul>
				<div class="table-responsive">
					<table class="table table-bordered">
						<thead>
							<tr style="font-weight: bold; color: lightblue; font-size: 1.2em; font-family: 'Roboto', sans-serif;">
								<td>Paper</td>
								<td>L</td>
								<td>P</td>
								<td>T</td>
								<td>TL</td>
								<td>TP</td>
								<td>TT</td>
								<td>ECA L</td>
								<td>ECA P</td>
								<td>ECA T</td>
							</tr>
						</thead>
						<tbody>
							{%for i in student_attendance%}
								<tr>
									<td>{{i.class_attendance.paper}}</td>
									<td>{{i.lecture}}</td>
									<td>{{i.practical}}</td>
									<td>{{i.tutorial}}</td>
									<td>{{i.class_attendance.lecture}}</td>
									<td>{{i.class_attendance.practical}}</td>
									<td>{{i.class_attendance.tutorial}}</td>
									<td>{{i.a_lecture}}</td>
									<td>{{i.a_practical}}</td>
									<td>{{i.a_tutorial}}</td>
								</tr>
							{%endfor%}
						</tbody>
					</table>
				</div>
			</div>
		</section>
	<div>
	{%endif%}









{%endif%}
    
    </div>

    <hr class="divider">

		<div class="row">
			<div id="contact">
				<p style="font-size: 1.3em; font-family: 'Roboto', sans-serif; font-weight: 300;">You may contact {{profile.title}} {{profile.user.first_name|capfirst}} using this form. </p>
				<form role="form" action='{{profile.get_absolute_url}}' action='POST'>
					<div class="form-group">
						<input name='from' class="form-control" type="email" placeholder="Your Email">
					</div>
					<div class="form-group">
						<input name='subject' class="form-control" type='text' placeholder="Subject">
					</div>
					<div class="form-group">
						<input name='message' class="form-control" type='textfield' placeholder="Your Message">
					</div>
					<button type="submit" class="btn btn-success" id="sub-button">Submit</button>
				</form>	
			</div>
		</div>
		<script type="text/javascript">
			if ($(window).width() <= 600) {
				$('#sub-button').addClass('btn-block');
			}
		</script>
{%endblock%}


